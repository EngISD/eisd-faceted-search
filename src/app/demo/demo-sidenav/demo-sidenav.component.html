<div class="container" [class.is-mobile]="mobileQuery.matches">
  <div class="subnavbar">
    <div class="filterIcons">
      <button class="filterButton" mat-icon-button (click)="snav.toggle()" (click)="toggle()">
        <mat-icon class="arrows" svgIcon="chevron-double-left" matListIcon *ngIf="!toggled"></mat-icon>
        <mat-icon class="arrows" svgIcon="chevron-double-right" matListIcon *ngIf="toggled"></mat-icon>
        <mat-icon class="filter1" svgIcon="filter-outline" matListIcon></mat-icon>
      </button>
      <button class="filterButton" mat-icon-button (click)="resetAll()">
          <mat-icon class="filter2" svgIcon="filter-outline" matListIcon></mat-icon>
          <mat-icon class="reset" svgIcon="close" matListIcon></mat-icon>
        </button>
    </div>
    <div class="sorting">
      <button mat-icon-button class="sortButton" (click)="sortResults()">
        <mat-icon svgIcon="arrow-collapse-up" *ngIf="descending"></mat-icon>
        <mat-icon svgIcon="arrow-collapse-down" *ngIf="!descending"></mat-icon>
      </button>
      <mat-form-field class="no-line">
          <mat-select placeholder="Ordina per">
            <mat-option value="some value">some value</mat-option>
          </mat-select>
        </mat-form-field>
    </div>
    <div class="paginator">
        <mat-paginator class="paginator-option"
        [length]="length"
        [pageIndex]="pageIndex"
        [pageSize]="pageSize"
        [pageSizeOptions]="pageSizeOptions"
        (page)="onPageChanged($event);">
        
    </mat-paginator>
    </div>
  </div>
  
  <mat-sidenav-container class="sidenav-container"
                          [style.marginTop.px]="mobileQuery.matches ? 0 : 0">
                          
    <mat-sidenav #snav [opened]="mobileQuery.matches ? 'false' : 'true'" [mode]="mobileQuery.matches ? 'over' : 'side'"
                  [fixedInViewport]="mobileQuery.matches" [fixedTopGap]="mobileQuery.matches ? 64 : 64">
      <mat-nav-list class="facet">
          <mat-expansion-panel [expanded]="i < 2" *ngFor="let category of categories; trackBy: trackByFn; let i = index">
              <mat-expansion-panel-header>
                <mat-panel-title class="noSelect">
                    <mat-icon class="catIcon" matListIcon>{{ category.icon }}</mat-icon>&nbsp;&nbsp;&nbsp;&nbsp;{{ category.id | titlecase }}
                </mat-panel-title>
              </mat-expansion-panel-header>
              <ng-template matExpansionPanelContent *ngIf="category.id != 'anno'">
                  <mat-selection-list dense [(ngModel)]="selected[category.id]" (ngModelChange)="onNgModelChange(category.id)" [ngModelOptions]="{standalone: true}">
                    <mat-list-option *ngFor="let checkbox of checkboxes[category.id]; trackBy: trackByFn;" [value]="checkbox.code">
                      <mat-icon matListIcon>label</mat-icon>
                      <p class="noSelect">{{ checkbox.descr }} ({{ checkbox.count }})</p>
                    </mat-list-option>
                    <button mat-raised-button class="moreButton" *ngIf="hasMore[category.id]" (click)="showMore(category.id)">Mostra di pi√π</button>
                    <button mat-raised-button class="moreButton" *ngIf="numMore[category.id] > 1" (click)="showLess(category.id)">Mostra meno</button>
                  </mat-selection-list>
              </ng-template>
              <ng-template matExpansionPanelContent *ngIf="category.id == 'anno'">
                <canvas baseChart *ngIf="barChartData[0].data.length > 0"
                    [datasets]="barChartData"
                    [labels]="barChartLabels"
                    [options]="barChartOptions"
                    [legend]="barChartLegend"
                    [colors]="barChartColors"
                    [chartType]="barChartType"
                    (chartHover)="chartHovered($event)"
                    (chartClick)="chartClicked($event)"></canvas>
              </ng-template>
            </mat-expansion-panel>
      </mat-nav-list>
    </mat-sidenav>
    <mat-sidenav-content>
      <ngx-loading [show]="loading" [config]="{animationType: ngxLoadingAnimationTypes.circle, primaryColour: primaryColour, secondaryColour: secondaryColour, backdropBorderRadius: '3px'}"></ngx-loading>
        <cdk-virtual-scroll-viewport itemSize="20" class="viewport">
          <div *cdkVirtualFor="let item of activePageDataChunk; let first = first;"  
               class="viewport-item mat-elevation-z1"
               [class.first] = "first"
               (click) = "openDialog(item)"
               >
            <div class="round mat-elevation-z4">{{ item.comCodice | slice:0:3 }}</div>
            <div class="feature"><mat-icon svgIcon="feature-search-outline" matListIcon></mat-icon></div>
            <div class="viewport-item-title">
              Com Codice: {{ item.comCodice }} Anno: {{ item.anno }} &nbsp;&nbsp;&nbsp;&nbsp;Descrizione: {{item.comDescrizione}}<br>
              Cliente: {{item.comCliente}} &nbsp;&nbsp;&nbsp;&nbsp;ClientPartitaIva: {{item.cliPartitaIva}} Tipologia: {{item.cliTipologia}}<br>
              Cdc Codice: {{item.cdcCodice}} Cdc Descrizione: {{item.cdcDescrizione}} &nbsp;&nbsp;&nbsp;&nbsp;Business Unit: {{item.cdcBusinessUnit}}<br>
              Cdc Responsabile: {{item.cdcResponsabile}} &nbsp;&nbsp;&nbsp;&nbsp;Responsabile: {{item.respCognome}} {{item.respNome}}
            </div>
          </div>
        </cdk-virtual-scroll-viewport>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>